<UserControl x:Class="SheetMusicOrganizer.View.Controls.Library.SongsGrid"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:tools="clr-namespace:SheetMusicOrganizer.View.Tools"
             xmlns:viewModel="clr-namespace:SheetMusicOrganizer.ViewModel"
             xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
             mc:Ignorable="d" 
             Name="MainControl"
             d:DesignHeight="450"
             d:DataContext="{d:DesignInstance viewModel:LibraryVM}" >
    <UserControl.Resources>
        <tools:RatingConverter x:Key="RatingConverter"/>
        <tools:DirFilenameConverter x:Key="DirFilenameConverter"/>
    </UserControl.Resources>
    <Border Style="{DynamicResource PopInBorder}">
        <Grid>
            <syncfusion:SfDataGrid x:Name="Songs" DataContext="{Binding SelectedPlaylist}" ItemsSource="{Binding Songs, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" AutoGenerateColumns="False"
                                   Style="{DynamicResource SongsDataGrid}" RowStyle="{DynamicResource SongDataGridRow}" AlternatingRowStyle="{DynamicResource SongDataGridAlternatingRow}"
                                   ScrollViewer.HorizontalScrollBarVisibility="Hidden" HideEmptyGridViewDefinition="True" EnableDataVirtualization="True"
                                   SelectionMode="Extended" SelectionUnit="Row" SelectedItems="{Binding SelectedSongs, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                   AllowSorting="True" SortColumnsChanged="Songs_SortColumnsChanged" SortColumnsChanging="Songs_SortColumnsChanging" DataContextChanged="Songs_DataContextChanged"
                                   AllowDraggingRows="True" AllowDraggingColumns="False" AllowDrop="False">
                <syncfusion:SfDataGrid.InputBindings>
                    <MouseBinding MouseAction="LeftDoubleClick" Command="{Binding ElementName=MainControl, Path=DataContext.PlaySelectedSongCommand}" CommandParameter="{Binding ElementName=Songs, Path=SelectedItem}"/>
                </syncfusion:SfDataGrid.InputBindings>
                <syncfusion:SfDataGrid.Columns>
                    <syncfusion:GridTextColumn HeaderText="#" MappingName="Number" Width="25" AllowResizing="False"/>
                    <syncfusion:GridTextColumn HeaderText="Title" MappingName="Title" Width="190"/>
                    <syncfusion:GridTextColumn HeaderText="Artist" MappingName="Artist" Width="170"/>
                    <syncfusion:GridTextColumn HeaderText="Album" MappingName="Album" Width="170"/>
                    <syncfusion:GridTextColumn HeaderText="Genre" MappingName="Genre" Width="100"/>
                    <syncfusion:GridTextColumn HeaderText="Length" MappingName="LengthMD" Width="52"/>
                    <syncfusion:GridTextColumn HeaderText="Codec" MappingName="CodecMD" Width="52"/>
                    <syncfusion:GridTextColumn HeaderText="Bitrate" MappingName="BitrateMD" Width="65"/>
                    <syncfusion:GridTextColumn HeaderText="Rating" MappingName="Rating" DisplayBinding="{Binding Path=Rating, Converter={StaticResource RatingConverter}}" Width="62"/>
                    <syncfusion:GridTextColumn HeaderText="Mastery" MappingName="Mastery.Name" Width="60" CellStyle="{DynamicResource MasteryGridCell}"/>
                    <syncfusion:GridTextColumn HeaderText="Music Sheet Name" MappingName="PartitionDirectory" DisplayBinding="{Binding Path=PartitionDirectory, Converter={StaticResource DirFilenameConverter}}"
                                           AllowResizing="False" ColumnSizer="AutoLastColumnFill">
                        <syncfusion:GridTextColumn.ToolTipTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding PartitionDirectory}"></TextBlock>
                            </DataTemplate>
                        </syncfusion:GridTextColumn.ToolTipTemplate>
                    </syncfusion:GridTextColumn>
                </syncfusion:SfDataGrid.Columns>
            </syncfusion:SfDataGrid>
            <StackPanel Orientation="Horizontal" Margin="0,25" HorizontalAlignment="Center" VerticalAlignment="Top">
                <StackPanel.Style>
                    <Style TargetType="{x:Type StackPanel}">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ElementName=Songs, Path=DataContext.Songs.Count}" Value="0">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </StackPanel.Style>
                <Border Style="{DynamicResource PopOutBorder}" Margin="5,0">
                    <Button Name="AddNewSongButton" Click="AddNewSongButton_Click" Style="{DynamicResource 3DButton}">
                        <StackPanel Orientation="Horizontal" Margin="0,5">
                            <Image Source="{DynamicResource MusicFileImage}" MaxHeight="20" Margin="0, 0, 10, 0"/>
                            <TextBlock Text="Add New Song" VerticalAlignment="Center" Foreground="{StaticResource ClickableSolidColor}"/>
                        </StackPanel>
                    </Button>
                </Border>
                <Border Style="{DynamicResource PopOutBorder}" Margin="5,0">
                    <Button Name="AddFolderButton" Click="AddFolderButton_Click" Style="{DynamicResource 3DButton}">
                        <StackPanel Orientation="Horizontal" Margin="0,5">
                            <Image Source="{DynamicResource MusicDirImage}" MaxHeight="20" Margin="0, 0, 10, 0"/>
                            <TextBlock Text="Add Folder" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </Border>
            </StackPanel>
        </Grid>
    </Border>
</UserControl>
